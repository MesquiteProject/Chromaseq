<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!-- InstanceBegin template="/Templates/ChromaseqTemplate.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />


<!-- InstanceBeginEditable name="doctitle" -->
<title>Workflow Suggestions</title>
<!-- InstanceEndEditable -->

<![endif]--><!--[if IE]>
<style type="text/css"> 
/* place css fixes for all versions of IE in this conditional comment */
.thrColFixHdr #sidebar2, .thrColFixHdr #sidebar1 { padding-top: 30px; }
.thrColFixHdr #mainContent { zoom: 1; }
/* the above proprietary zoom property gives IE the hasLayout it needs to avoid several bugs */
</style>
<![endif]-->

<style type="text/css">
<!--
-->
</style>
<link href="CSS/mesquitePackage.css" rel="stylesheet" type="text/css" />
<link href="SpryAssets/SpryCollapsiblePanel.css" rel="stylesheet" type="text/css" />

<script src="SpryAssets/SpryCollapsiblePanel.js" type="text/javascript"></script>
<script type="text/javascript" src="SpryAssets/SpryURLUtils.js"></script>
<script type="text/javascript" src="javascript/mesquiteChromaseq.js"></script>

<!-- InstanceBeginEditable name="head" -->
<!-- InstanceEndEditable -->
</head>

<body bgcolor="#f4f0e2" class="thrColFixHdr" >

<div id="container">
  <div id="header">
    <table width="100%" border="0" cellpadding="4">
  <tr>
    <td width="51%"><strong id="PackageTitle">Chromaseq</strong></td>
    <td width="33%" align="right"><div id="subtitle"><!-- InstanceBeginEditable name="subtitle" -->Workflow Suggestions<!-- InstanceEndEditable --></div></td>
    <td width="2%">&nbsp;</td>
    <td width="14%"><p>Version 1.5 <br />
      27 December
2018<br />
      </p></td>
  </tr>
</table>

</div>
  
  
<div id="sidebar1">
  
  
  
  
  <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('index.html')">Home</a>
  </div>
  <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('overview.html')">Overview</a>
  </div>
  <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('download.html')">Download</a>
  </div>

  <div id="GettingStartedPanel" class="CollapsiblePanel">
    <div class="CollapsiblePanelTab" tabindex="0">Getting Started ˇ</div>
    <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('download.html');">Download</a></td></tr>
  			<tr><td><a href="javascript:pageLink('installation.html');">Installation</a></td></tr>
  			<tr><td><a href="javascript:pageLink('quickstart.html');">Quick Start</a></td></tr>
  			<tr><td><a href="javascript:pageLink('tutorial.html');">Tutorial</a></td></tr>
		</table>
    </div>
  </div>
  <div id="PreparingDataPanel" class="CollapsiblePanel">
    <div class="CollapsiblePanelTab" tabindex="0">Preparing Data ˇ</div>
    <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('chromatograms.html');">Chromatograms</a></td></tr>
  			<tr><td><a href="javascript:pageLink('fileNamingRules.html');">File Naming Rules</a></td></tr>
  			<tr><td><a href="javascript:pageLink('sampleCode.html');">Samples & Sequence Names</a></td></tr>
  			<tr><td><a href="javascript:pageLink('primers.html');">Primer & Gene Information</a></td></tr>
		</table>
    </div>
  </div>
  
<div id="ProcessingChromatoPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Processing Chromatograms ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr> <td><a href="javascript:pageLink('preparation.html');">Preparation & Processing</a></td></tr>
  			<tr><td><a href="javascript:pageLink('phredPhrap.html');">Phred & Phrap Locations & Options</a></td></tr>
  			<tr><td><a href="javascript:pageLink('postPhrap.html');">Post-Phrap Options</a></td></tr>
  			<tr> <td><a href="javascript:pageLink('quality.html');">Quality Scores & Colors</a></td></tr>
  			<tr> <td><a href="javascript:pageLink('segregatingChromatograms.html');">Segregating Chromatogram Files</a></td></tr>
  			<tr> <td><a href="javascript:pageLink('appendingSequences.html');">Processing Additional Chromatograms</a></td></tr>
		</table>
  </div>
</div>


<div id="ChromatogramViewerPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Chromatogram Viewer ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('viewer.html');">Viewing Chromatograms</a></td></tr>
  			<tr>  <td><a href="javascript:pageLink('callingBases.html');">Altering Base Calls</a></td></tr>
  			<tr><td><a href="javascript:pageLink('conflicts.html');">Detecting Conflicts</a></td></tr>
  			<tr>  <td><a href="javascript:pageLink('primerSites.html');">Displaying Primer Sites</a></td></tr>
  			<tr>  <td><a href="javascript:pageLink('extraSequences.html');">Multiple Reads/Contigs at Once</a></td></tr>
  			<tr><td><a href="javascript:pageLink('display.html');">Other Display Options</a></td></tr>
			<tr><td><a href="javascript:pageLink('navigation.html');">Navigation</a></td></tr>
		</table>
  </div>
</div>

<div id="GenBankPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">GenBank Submission ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('genbank.html');">GenBank via tbl2asn</a></td></tr>
  			<tr><td><a href="javascript:pageLink('genbankSequin.html');">GenBank via Sequin</a></td></tr>
		</table>
  </div>
</div>

<div id="OtherFeaturesPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Other Features ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('listWindow.html');">List Window Features</a></td></tr>
  			<tr><td><a href="javascript:pageLink('matrixCells.html');">Matrix Colors</a></td></tr>
  			<tr><td><a href="javascript:pageLink('purging.html');">Purging Chromaseq Data</a></td></tr>
  			<tr><td><a href="javascript:pageLink('helpfulMesquite.html');">Helpful Mesquite Features</a></td></tr>
		</table>
  </div>
</div>
  <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('workflow.html')">Workflow Suggestions</a>
  </div>

<div id="HelpPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Help & Info ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('tutorial.html');">Tutorial</a></td></tr>
  			<tr><td><a href="javascript:pageLink('faq.html');">FAQ</a></td></tr>
  			<tr><td><a href="javascript:pageLink('troubleshooting.html');">Troubleshooting</a></td></tr>
  			<tr><td><a href="javascript:pageLink('chromaseqList.html');">Chromaseq E-mail List</a></td></tr>
  			<tr><td><a href="javascript:pageLink('limitations.html');">Limitations</a></td></tr>
  			<tr><td><a href="javascript:pageLink('otherPrograms.html');">Chromaseq &amp; Other Programs</a></td></tr>
  			<tr><td><a href="javascript:pageLink('future.html');">Future Directions</a></td></tr>
	</table>
  </div>
</div>

<div id="TechnicalPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Technical Details ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('sourceCode.html');">Source Code</a></td></tr>
  			<tr><td><a href="javascript:pageLink('technicalFAQ.html');">Technical FAQ</a></td></tr>
		</table>
  </div>
</div>
  <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('knownIssues.html')">Known Issues</a>
  </div>
  <div id="NonCollapsiblePanel">
    <a href="javascript:pageLink('versions.html')">Versions</a>
  </div>

<div id="CreditPanel" class="CollapsiblePanel">
  <div class="CollapsiblePanelTab" tabindex="0">Citation & Credit ˇ</div>
  <div class="CollapsiblePanelContent" style="display: block">
  		<table width="100%" border="0" cellpadding="1">
  			<tr><td><a href="javascript:pageLink('citation.html');">How to Cite</a></td></tr>
  			<tr><td><a href="javascript:pageLink('acknowledgements.html');">Acknowledgements</a></td></tr>
		</table>
  </div>
</div>


<h3>&nbsp;</h3>
  <!-- end #sidebar1 --></div>

  <div id="mainContent">
    
<!-- InstanceBeginEditable name="content" -->
<p>As a general recommendation, one should always save intermediate versions of your edited file. Ideally you would name then in some way that would make it obvious the order (for example, you can include numbers in the file name to indicate the order of the files).</p>
<hr />
<h3>Workflow 1: David's workflow</h3>
<p>I have a FileMaker Pro database of all of my sample voucher numbers and sample information. Each record in the database includes the voucher number (which is automatically embedded in the chromatogram file name by the sequencing facility), the species name, authority, who identified the specimen, latitude longitude of the specimen, and other information. The database contains a script that outputs the voucher number and species name into a text file that follows the <a href="sampleCode.html">Sample Codes and Sequence Names File</a> format. I output this file, and put it into a standard place on my computer. Once that is set up, and the <a href="primers.html">Primer File</a> is set up, I can then do my processing.</p>
<p>I normally do initial processing when I get sequences from a plate or two. I put all of the chromatograms in one directory, save a backup of them, and then choose File&gt;Open Other&gt;Process Chromatogram Files in Directory, chosing that directory. Once it is all done, if I wish to do some quick analyses to see how the sequences turned out, I normally want to incorporate the preliminary sequences into a large, existing matrix. I do this by <a href="helpfulMesquite.html#importFASTA">dropping the FASTA files onto the matrix</a>. I then do a quick alignment using  <a href="helpfulMesquite.html#alignmentTools">Shift Other to Match</a>, which allows me to check to see any of the sequences are reverse complements (and, if they are, I select them and use Matrix&gt;Alter/Transform&gt;Reverse Complement, and then try Shift Other To Match again). If that is not sufficient, I may use the Pairwise alignment tool, or use a full matrix aligner, like Opal. I can then save the matrix and use other phylgoenetics programs to quickly infer the phylogeny and see how things look.</p>
<p>If I want to do final base calls, I first align the sequences within the Chromaseq-produced Mesquite matrix. I generally use Shift Other to Match first, and make sure none of the sequences are reversed complemented (or I use Matrix&gt;Alter/Transform&gt;Reverse Complement to correct those that are). Having the sequences aligned allows me to better judge how a particular sequence's length compares to the typical one, and, if shorter, decide if it is worth making harder base calls to lengthen it. It also allows me to spot sequences whose primer sequences I have neglected to remove, and the occasional base missed by Phred/Phrap/Chromaseq. </p>
<p>Once final base calls are made, I can then export the sequences using the File&gt;Export options, usually to FASTA format, if I want to incorporate the results into another matrix.</p>
<p>And, then, finally, I use my database of sample information to produce the voucher information file that is used to produce FASTA files suitable for quicker <a href="genbank.html">GenBank submission</a>.</p>
<hr />
<h3>Workflow 2: Wayne's workflow</h3>
<p>Here are some steps in my workflow, starting before the chromatograms are processed.</p>
<h4>File Names</h4>
<p>The names of my chromatogram files are adjusted to be like this:</p>
<p>d142#100719-spwr.ab1</p>
<p>i.e., having the general form:</p>
<p>	SampleCode#DateOfSequencing-PrimerCode.ab1</p>
<p>Date of sequencing is YYMMDD.</p>
<p>The rules for chromatogram files are thus:</p>
<ul>
  <li>Sample code precedes primer name</li>
  <li>String before sample code: </li>
  <li>String after sample code: #</li>
  <li>String before sample code suffix:</li>
  <li>Characters to be removed from sample code:</li>
  <li>String before primer name: -</li>
  <li>String after primer name:</li>
</ul>
<h4>Preparation of windows</h4>
<p>After the chromatograms are processed using Mesquite, Phred and Phrap, and I have a NEXUS file in Mesquite, I prepare windows as follows.</p>
<p>Notes Window: I usually ask for a Window&gt;New Notes Window, which I then put into a separate tile (by touching on arrow on the window's tab) and the shrink to a narrow strip at right.  I then take notes about issues and decisions made, as needed.</p>
<p>The Character matrix editor is set to show colors as follows:<br />
  Matrix&gt;Color Matrix Cells&gt;Quality from Phred/Phrap.  This is the default after processing by Mesquite<br />
  Matrix&gt;Color Taxon names background: Chromaseq markings.  I set it to this to be able to use the thumbs down, pink and orange eye tools to assign a color to the taxon name background, so as to be able to sort or select the sequences in different categories.  My convention is to use red (thumbs down) for a sequence I'll not use (e.g. delete wholesale), pink for a good sequence I'll use, and orange for something else, e.g. to indicate that the sequence is available in another data file. Later, I can use the taxon magic wand, set to select by color, and thus select all red taxa to delete them, or move them to the end of the matrix, etc.</p>
<h4>Initial Editing &amp; Marking</h4>
<p>I use the chromatogram tool from the data editor to view a chromatogram window.  In the chromatogram window I ask to Show Read Matrix conflict to spot situations where I need to check.  Most common Read-Matrix conflicts in good sequences are cases where Mesquite was overly conservative in double peaks, and I can resolve to a single base.</p>
<p>Usually near the ends (blue, low quality), there are sections I decide to trim just to be conservative.  I do that by selecting those sections and the using the thumbs down tool to make them red.  I don't trim them yet; that's for later.</p>
<p>Problem areas I may color pink to indicate I need to go back and look at them again.</p>
<h4>If two reads don't form a contig.</h4>
<p>Sometimes the forward and reverse read will appear as two separate rows in the matrix, because Mesquite/Phred/Phrap was unable to align the two reads into a single contig.  This may happen because the sequences decayed before they overlapped, or there was a stretch of a single nucleotide replicated many times.  When this happens I go to the chromatogram window for one of the reads, and then ask for Chromatograms&gt;Extra Sequences&gt;Show Extra Sequences, choosing the other read so that both are shown at the same time.</p>
<p>With both sequences shown, scrolling one or the other changes the color of the sequence shown between the two panels -- yellow for well aligned, red and green for misaligned left or right.  You can attemp to scroll until the sequence shows yellow and then use the lock icon to link the scrolling, or you can ask Mesquite to attempt to align by hitting the align icon (three bars that look like a face).</p>
<p>It is likely that one of the reads is in reverse complement compared to the other.  Therefore, in the chromatogram viewer, before attempting to align the two different sequences, you may have to hit the reverse icon (arrow) and the complement icon (c) on one of the sequences.  After you do this the scroll bars become counter-intuitive.</p>
<p>Once you have aligned the reads, you can use the coloring (pink and orange eyes) in the chromatogram window to mark points of boundaries in the two reads, and later you can go back to the Matrix Editor and select the sequence from one of the reads, copy, and paste into the other read.  You may need to reverse complement one read before doing this.</p>
<p>The Show Extra Sequences feature can also be used to compare sequences from two different specimens.</p>
<h4>Changing to gaps</h4>
<p>Once the basic editing is done, I then go to the matrix editor to change all the red sections (those to be deleted) to gaps.  To do that, choose the magic wand tool, hold down the cursor until the drop down menu appears, and choose Select by Color.  Then touch on a cell colored red.  All red cells will be selected. Then select the Select and Type tool (K), and hit the &quot;-&quot; key to fill all red to gaps.</p>
<h4>Other Mesquite features</h4>
<p>There are many other aspects to my workflow that extend beyond Chromaseq features, including use of the Alternative Taxon Names system available under Columns in the List of Taxa window.  This permits me to store one set of taxon names that includes voucher numbers, another that is based on the formal taxon names, and so forth.  The different taxon naming schemes can be swapped from the stored alternatives to permit reading of tree files (with coded names) and then display of the trees (with formal names). </p>
<p>&nbsp;</p>
<!-- InstanceEndEditable -->

    
    
    </div>
	<!-- This clearing element should immediately follow the #mainContent div in order to force the #container div to contain all child floats --><br class="clearfloat" />
  <div id="footer">
    <p> ©2018 David R. Maddison &amp; Wayne P. Maddison</p>
  <!-- end #footer --></div>
<!-- end #container --></div>

<script type="text/javascript">
<!--


var GettingStartedPanel = null;
var ChromatogramViewerPanel = null;
var ProcessingChromatoPanel = null;
var PreparingDataPanel = null;
var CreditPanel = null;
var HelpPanel = null;
var GenBankPanel = null;
var OtherFeaturesPanel = null;
var TechnicalPanel = null;

if (qsParm['ProcessingChromatoPanel']=='open')
 	ProcessingChromatoPanel = new Spry.Widget.CollapsiblePanel("ProcessingChromatoPanel", {contentIsOpen: true});
else
 	ProcessingChromatoPanel = new Spry.Widget.CollapsiblePanel("ProcessingChromatoPanel", {contentIsOpen: false});
	
if (qsParm['GettingStartedPanel']=='open')
 	GettingStartedPanel = new Spry.Widget.CollapsiblePanel("GettingStartedPanel", {contentIsOpen: true});
else
 	GettingStartedPanel = new Spry.Widget.CollapsiblePanel("GettingStartedPanel", {contentIsOpen: false});
	
if (qsParm['ChromatogramViewerPanel']=='open')
 	ChromatogramViewerPanel = new Spry.Widget.CollapsiblePanel("ChromatogramViewerPanel", {contentIsOpen: true});
else
 	ChromatogramViewerPanel = new Spry.Widget.CollapsiblePanel("ChromatogramViewerPanel", {contentIsOpen: false});

if (qsParm['PreparingDataPanel']=='open')
 	PreparingDataPanel = new Spry.Widget.CollapsiblePanel("PreparingDataPanel", {contentIsOpen: true});
else
 	PreparingDataPanel = new Spry.Widget.CollapsiblePanel("PreparingDataPanel", {contentIsOpen: false});

if (qsParm['CreditPanel']=='open')
 	CreditPanel = new Spry.Widget.CollapsiblePanel("CreditPanel", {contentIsOpen: true});
else
 	CreditPanel = new Spry.Widget.CollapsiblePanel("CreditPanel", {contentIsOpen: false});

if (qsParm['HelpPanel']=='open')
 	HelpPanel = new Spry.Widget.CollapsiblePanel("HelpPanel", {contentIsOpen: true});
else
 	HelpPanel = new Spry.Widget.CollapsiblePanel("HelpPanel", {contentIsOpen: false});

if (qsParm['GenBankPanel']=='open')
 	GenBankPanel = new Spry.Widget.CollapsiblePanel("GenBankPanel", {contentIsOpen: true});
else
 	GenBankPanel = new Spry.Widget.CollapsiblePanel("GenBankPanel", {contentIsOpen: false});
    
if (qsParm['OtherFeaturesPanel']=='open')
 	OtherFeaturesPanel = new Spry.Widget.CollapsiblePanel("OtherFeaturesPanel", {contentIsOpen: true});
else
 	OtherFeaturesPanel = new Spry.Widget.CollapsiblePanel("OtherFeaturesPanel", {contentIsOpen: false});
    
if (qsParm['TechnicalPanel']=='open')
 	TechnicalPanel = new Spry.Widget.CollapsiblePanel("TechnicalPanel", {contentIsOpen: true});
else
 	TechnicalPanel = new Spry.Widget.CollapsiblePanel("TechnicalPanel", {contentIsOpen: false});



//-->
</script>
</body>
<!-- InstanceEnd --></html>
